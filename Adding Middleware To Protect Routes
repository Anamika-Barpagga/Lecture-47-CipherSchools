const deleteUser = async(req,res)=>{
  const {id: userId} = req.params;
  const deleteResult = await User.deleteOne({_id:userId);
  if(!deleteResult.deletedCount){
    console.error(" Delete Failed! User with ID: ${userId} wasnot found ");
    return res.status(404).send({message: "Delete Failed! User with ID: ${userId} wasnot found"})
  })
  console.info("Delete Success: User with ID: ${userId} was deleted")
  return res.status(200).send({message: "Delete Success!"});
};

module.exports = {addNewUser, loginUser};

const {verifyToken} = require("../jwt");
const authMiddleware = async(req,res,next)=>{
 //{authorization:"Bearer <token>"} 
  const {authorization} = req.headers;
  const token = authorization.substring(7);
  const {isValidToken, payload} = verifyToken(token);
  if (isValidToken){
    console.log("Token is Valid");
    next();
  }else{
    console.warn("Token is invalid");
    return res.status(403).send({message: "Please use a valid token!"})
  }
};

module.exports = authMiddleware;
